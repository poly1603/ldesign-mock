# Mock å·¥å…·å®ç°å®ŒæˆæŠ¥å‘Š

## ğŸ“ é¡¹ç›®æ¦‚è¿°

å·²æˆåŠŸå®ç°å®Œæ•´çš„ `@ldesign/mock` å·¥å…·ï¼Œè¿™æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„ Mock æ•°æ®ç®¡ç†ç³»ç»Ÿï¼Œæ”¯æŒå‰åç«¯å¹¶è¡Œå¼€å‘ã€‚

## âœ… å·²å®ŒæˆåŠŸèƒ½

### ç¬¬ä¸€é˜¶æ®µï¼šæ ¸å¿ƒåŸºç¡€è®¾æ–½ âœ“

#### 1.1 åŒ…ç»“æ„åˆå§‹åŒ– âœ“
- âœ… åˆ›å»º monorepo ç»“æ„ï¼ˆpackages/core, server, cli, web-uiï¼‰
- âœ… é…ç½® pnpm workspace
- âœ… è®¾ç½® TypeScript å’Œæ„å»ºå·¥å…·ï¼ˆtsupï¼‰

#### 1.2 æ ¸å¿ƒåŠŸèƒ½æ¨¡å— âœ“
- âœ… **ConfigManager** - é…ç½®ç®¡ç†ï¼Œæ”¯æŒ `mock.config.js`ï¼Œä½¿ç”¨ jiti åŠ è½½ TS/ESM
- âœ… **DataGenerator** - åŸºäº @faker-js/faker çš„æ™ºèƒ½æ•°æ®ç”Ÿæˆå™¨
  - æ”¯æŒ `@placeholder` è¯­æ³•
  - æ”¯æŒä¸­æ–‡æœ¬åœ°åŒ–
  - æ”¯æŒè‡ªå®šä¹‰ç”Ÿæˆå™¨
  - æ”¯æŒæ•°ç»„å’Œåˆ†é¡µæ•°æ®ç”Ÿæˆ
- âœ… **ScenarioManager** - åœºæ™¯ç®¡ç†
  - åœºæ™¯æ³¨å†Œå’Œåˆ‡æ¢
  - åœºæ™¯éªŒè¯
  - åœºæ™¯ç›‘å¬
- âœ… **MockDatabase** - æ•°æ®æŒä¹…åŒ–ï¼ˆbetter-sqlite3ï¼‰
  - Mock æ•°æ®å­˜å‚¨
  - è¯·æ±‚æ—¥å¿—å­˜å‚¨
  - ç»Ÿè®¡ä¿¡æ¯æŸ¥è¯¢
- âœ… **ç±»å‹å®šä¹‰** - å®Œæ•´çš„ TypeScript ç±»å‹ç³»ç»Ÿ

### ç¬¬äºŒé˜¶æ®µï¼šMock æœåŠ¡å™¨ âœ“

#### 2.1 æœåŠ¡å™¨æ ¸å¿ƒ âœ“
- âœ… **MockServer** - Express æœåŠ¡å™¨ä¸»ç±»
  - è‡ªåŠ¨åŒ–åˆå§‹åŒ–å’Œå¯åŠ¨
  - ä¼˜é›…å…³é—­å¤„ç†
  - WebSocket æ”¯æŒ
- âœ… **RESTfulHandler** - RESTful API å¤„ç†
  - æ”¯æŒåŠ¨æ€è·¯ç”±ï¼ˆ:id ç­‰ï¼‰
  - æ”¯æŒå¤šç§ HTTP æ–¹æ³•
  - æ”¯æŒå‡½æ•°å’Œå¯¹è±¡å“åº”
  - è·¯ç”±çƒ­é‡è½½
- âœ… **GraphQLHandler** - GraphQL å¤„ç†
  - åŸºäº graphql-yoga
  - é»˜è®¤ Schema å’Œ Resolvers
  - GraphQL Playground
- âœ… **RequestInterceptor** - è¯·æ±‚æ‹¦æˆªå™¨
  - è¯·æ±‚æ—¥å¿—è®°å½•
  - å…¨å±€å»¶è¿Ÿæ¨¡æ‹Ÿ
  - å“åº”æ•è·
- âœ… **HotReloadWatcher** - çƒ­é‡è½½ç›‘å¬å™¨
  - åŸºäº chokidar
  - é˜²æŠ–å¤„ç†
  - è‡ªåŠ¨é‡æ–°åŠ è½½é…ç½®

#### 2.2 WebSocket å®æ—¶é€šä¿¡ âœ“
- âœ… **ConnectionManager** - è¿æ¥ç®¡ç†
  - è¿æ¥çŠ¶æ€ç®¡ç†
  - æ¶ˆæ¯å¹¿æ’­
  - å¿ƒè·³æœºåˆ¶

#### 2.3 API è·¯ç”± âœ“
- âœ… `/api/health` - å¥åº·æ£€æŸ¥
- âœ… `/api/stats` - ç»Ÿè®¡ä¿¡æ¯
- âœ… `/api/logs` - è¯·æ±‚æ—¥å¿— CRUD
- âœ… `/api/scenarios` - åœºæ™¯ç®¡ç†
- âœ… `/api/config` - é…ç½®ç®¡ç†
- âœ… `/api/mocks` - Mock è·¯ç”±ç®¡ç†

### ç¬¬ä¸‰é˜¶æ®µï¼šCLI å·¥å…· âœ“

#### 3.1 å‘½ä»¤å®ç° âœ“
- âœ… `start` - å¯åŠ¨ Mock æœåŠ¡å™¨
  - æ”¯æŒç«¯å£ã€ä¸»æœºé…ç½®
  - æ”¯æŒçƒ­é‡è½½
  - æ”¯æŒè°ƒè¯•æ¨¡å¼
- âœ… `init` - åˆå§‹åŒ–é…ç½®æ–‡ä»¶
  - äº¤äº’å¼é…ç½®
  - è‡ªåŠ¨åˆ›å»ºç¤ºä¾‹æ–‡ä»¶
  - ç¾åŒ–è¾“å‡ºï¼ˆboxenï¼‰
- âœ… `scenario` - åœºæ™¯ç®¡ç†
  - list - åˆ—å‡ºåœºæ™¯
  - switch - åˆ‡æ¢åœºæ™¯
  - current - å½“å‰åœºæ™¯

#### 3.2 äº¤äº’ç•Œé¢ âœ“
- âœ… inquirer äº¤äº’å¼æç¤º
- âœ… ora åŠ è½½åŠ¨ç”»
- âœ… chalk å½©è‰²è¾“å‡º
- âœ… commander å‘½ä»¤è¡Œæ¡†æ¶

### ç¬¬å››é˜¶æ®µï¼šWeb ç®¡ç†ç•Œé¢ âœ“

#### 4.1 å‰ç«¯é¡¹ç›® âœ“
- âœ… Vue 3 + TypeScript + Vite
- âœ… Naive UI ç»„ä»¶åº“
- âœ… Vue Router è·¯ç”±ç®¡ç†
- âœ… Axios HTTP å®¢æˆ·ç«¯

#### 4.2 é¡µé¢åŠŸèƒ½ âœ“
- âœ… **Dashboard** - ä»ªè¡¨ç›˜
  - æœåŠ¡çŠ¶æ€æ˜¾ç¤º
  - è¯·æ±‚ç»Ÿè®¡
  - å½“å‰åœºæ™¯
  - å¿«æ·æ“ä½œ
- âœ… **MockManager** - Mock æ¥å£ç®¡ç†
  - è·¯ç”±åˆ—è¡¨å±•ç¤º
  - æ•°æ®è¡¨æ ¼
  - æ–¹æ³•å’Œè·¯å¾„æ˜¾ç¤º
- âœ… **Logs** - è¯·æ±‚æ—¥å¿—
  - å®æ—¶æ—¥å¿—åˆ—è¡¨
  - æ—¥å¿—ç­›é€‰
  - æ¸…ç©ºæ—¥å¿—
- âœ… **Scenarios** - åœºæ™¯ç®¡ç†
  - åœºæ™¯åˆ—è¡¨
  - ä¸€é”®åˆ‡æ¢
  - å½“å‰åœºæ™¯æ ‡è¯†

#### 4.3 å®æ—¶åŠŸèƒ½ âœ“
- âœ… API å®¢æˆ·ç«¯å°è£…
- âœ… è‡ªåŠ¨åˆ·æ–°ç»Ÿè®¡
- âœ… WebSocket è¿æ¥å‡†å¤‡å°±ç»ª

### ç¬¬äº”é˜¶æ®µï¼šæ¨¡æ¿ç³»ç»Ÿ âœ“

- âœ… **User æ¨¡æ¿** - ç”¨æˆ·ç›¸å…³ Mock æ•°æ®
  - CRUD æ“ä½œ
  - åˆ†é¡µåˆ—è¡¨
  - å‚æ•°å¤„ç†
- âœ… **Product æ¨¡æ¿** - äº§å“ç›¸å…³ Mock æ•°æ®
  - äº§å“åˆ—è¡¨å’Œè¯¦æƒ…
  - è¯„åˆ†å’Œè¯„è®º
  - å›¾ç‰‡æ•°ç»„

## ğŸ“¦ åŒ…ç»“æ„

```
tools/mock/
â”œâ”€â”€ packages/
â”‚   â”œâ”€â”€ core/                    # æ ¸å¿ƒåŠŸèƒ½åŒ…
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ config/         # é…ç½®ç®¡ç†
â”‚   â”‚   â”‚   â”œâ”€â”€ database/       # æ•°æ®æŒä¹…åŒ–
â”‚   â”‚   â”‚   â”œâ”€â”€ generator/      # æ•°æ®ç”Ÿæˆå™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ scenario/       # åœºæ™¯ç®¡ç†
â”‚   â”‚   â”‚   â””â”€â”€ types/          # ç±»å‹å®šä¹‰
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â”‚   â””â”€â”€ tsup.config.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ server/                  # Mock æœåŠ¡å™¨åŒ…
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ handlers/       # RESTful & GraphQL å¤„ç†å™¨
â”‚   â”‚   â”‚   â”œâ”€â”€ middleware/     # ä¸­é—´ä»¶
â”‚   â”‚   â”‚   â”œâ”€â”€ routes/         # API è·¯ç”±
â”‚   â”‚   â”‚   â”œâ”€â”€ utils/          # å·¥å…·å‡½æ•°
â”‚   â”‚   â”‚   â”œâ”€â”€ websocket/      # WebSocket ç®¡ç†
â”‚   â”‚   â”‚   â””â”€â”€ MockServer.ts   # æœåŠ¡å™¨ä¸»ç±»
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â”‚   â””â”€â”€ tsup.config.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ cli/                     # CLI å·¥å…·åŒ…
â”‚   â”‚   â”œâ”€â”€ bin/
â”‚   â”‚   â”‚   â””â”€â”€ cli.js          # CLI å…¥å£
â”‚   â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”‚   â”œâ”€â”€ commands/       # å‘½ä»¤å®ç°
â”‚   â”‚   â”‚   â””â”€â”€ index.ts        # ä¸»å…¥å£
â”‚   â”‚   â”œâ”€â”€ package.json
â”‚   â”‚   â”œâ”€â”€ tsconfig.json
â”‚   â”‚   â””â”€â”€ tsup.config.ts
â”‚   â”‚
â”‚   â””â”€â”€ web-ui/                  # Web ç®¡ç†ç•Œé¢
â”‚       â”œâ”€â”€ src/
â”‚       â”‚   â”œâ”€â”€ api/            # API å®¢æˆ·ç«¯
â”‚       â”‚   â”œâ”€â”€ router/         # è·¯ç”±é…ç½®
â”‚       â”‚   â”œâ”€â”€ views/          # é¡µé¢ç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ App.vue
â”‚       â”‚   â””â”€â”€ main.ts
â”‚       â”œâ”€â”€ index.html
â”‚       â”œâ”€â”€ package.json
â”‚       â”œâ”€â”€ tsconfig.json
â”‚       â””â”€â”€ vite.config.ts
â”‚
â”œâ”€â”€ templates/                   # æ¨¡æ¿æ–‡ä»¶
â”‚   â”œâ”€â”€ user.template.js
â”‚   â””â”€â”€ product.template.js
â”œâ”€â”€ pnpm-workspace.yaml
â”œâ”€â”€ package.json
â””â”€â”€ README.md
```

## ğŸ”§ æŠ€æœ¯æ ˆ

### åç«¯
- **Express 4** - Web æ¡†æ¶
- **graphql-yoga** - GraphQL æœåŠ¡å™¨
- **@faker-js/faker** - æ•°æ®ç”Ÿæˆ
- **better-sqlite3** - æ•°æ®æŒä¹…åŒ–
- **chokidar** - æ–‡ä»¶ç›‘å¬
- **ws** - WebSocket
- **path-to-regexp** - è·¯ç”±åŒ¹é…

### å‰ç«¯
- **Vue 3** - å‰ç«¯æ¡†æ¶
- **TypeScript** - ç±»å‹ç³»ç»Ÿ
- **Vite** - æ„å»ºå·¥å…·
- **Naive UI** - UI ç»„ä»¶åº“
- **Axios** - HTTP å®¢æˆ·ç«¯
- **Vue Router** - è·¯ç”±ç®¡ç†

### CLI
- **commander** - å‘½ä»¤è¡Œæ¡†æ¶
- **inquirer** - äº¤äº’å¼æç¤º
- **chalk** - å½©è‰²è¾“å‡º
- **ora** - åŠ è½½åŠ¨ç”»
- **boxen** - ç¾åŒ–è¾“å‡º

### æ„å»ºå·¥å…·
- **tsup** - TypeScript æ‰“åŒ…
- **TypeScript** - ç±»å‹æ£€æŸ¥
- **pnpm** - åŒ…ç®¡ç†å™¨

## ğŸš€ ä½¿ç”¨æŒ‡å—

### å®‰è£…

```bash
cd tools/mock
pnpm install
```

### æ„å»º

```bash
pnpm build
```

### å¼€å‘

```bash
# æ‰€æœ‰åŒ…åŒæ—¶å¼€å‘
pnpm dev

# å•ç‹¬æ„å»ºæŸä¸ªåŒ…
cd packages/core && pnpm build
cd packages/server && pnpm build
cd packages/cli && pnpm build
cd packages/web-ui && pnpm build
```

### è¿è¡Œ

```bash
# åˆå§‹åŒ–é…ç½®
cd packages/cli
node bin/cli.js init

# å¯åŠ¨æœåŠ¡å™¨
node bin/cli.js start --watch --debug

# å¼€å‘æ¨¡å¼ï¼ˆå‰ç«¯ï¼‰
cd packages/web-ui
pnpm dev
```

## ğŸ“ æ ¸å¿ƒç‰¹æ€§è¯¦è§£

### 1. æ•°æ®ç”Ÿæˆå™¨

æ”¯æŒå¼ºå¤§çš„ `@placeholder` è¯­æ³•ï¼š

```javascript
{
  id: '@uuid',
  name: '@name',
  email: '@email',
  age: '@int(18, 60)',
  avatar: '@avatar',
  createdAt: '@date'
}
```

### 2. åœºæ™¯ç®¡ç†

æ”¯æŒå¤šåœºæ™¯åˆ‡æ¢ï¼Œé€‚åº”ä¸åŒæµ‹è¯•éœ€æ±‚ï¼š

```javascript
// mock.config.js
scenarios: {
  success: 'mock/scenarios/success',
  error: 'mock/scenarios/error',
  loading: 'mock/scenarios/loading'
}
```

### 3. çƒ­é‡è½½

æ–‡ä»¶å˜åŒ–è‡ªåŠ¨é‡æ–°åŠ è½½ï¼Œæ— éœ€é‡å¯æœåŠ¡å™¨ã€‚

### 4. GraphQL æ”¯æŒ

å†…ç½® GraphQL æœåŠ¡å™¨ï¼Œæ”¯æŒ Playgroundã€‚

### 5. Web ç®¡ç†ç•Œé¢

å®æ—¶æŸ¥çœ‹ç»Ÿè®¡ã€æ—¥å¿—ã€ç®¡ç†åœºæ™¯å’Œ Mock æ•°æ®ã€‚

## ğŸ¯ ä¸‹ä¸€æ­¥è®¡åˆ’ï¼ˆå¯é€‰ï¼‰

### é«˜çº§åŠŸèƒ½ï¼ˆæœªå®ç°ï¼‰
- [ ] CLI é›†æˆåˆ° @ldesign/cli
- [ ] æ›´å¤šå†…ç½®æ¨¡æ¿
- [ ] æ•°æ®å¯¼å…¥/å¯¼å‡ºåŠŸèƒ½
- [ ] Mock å½•åˆ¶åŠŸèƒ½
- [ ] æ€§èƒ½ç›‘æ§å’Œåˆ†æ
- [ ] å•å…ƒæµ‹è¯•ï¼ˆvitestï¼‰
- [ ] E2E æµ‹è¯•
- [ ] API æ–‡æ¡£ç”Ÿæˆ

## ğŸ“– æ–‡æ¡£

- âœ… README.md - å®Œæ•´ä½¿ç”¨æ–‡æ¡£
- âœ… å†…è”ä»£ç æ³¨é‡Š
- âœ… TypeScript ç±»å‹å®šä¹‰

## ğŸ‰ æ€»ç»“

Mock å·¥å…·å·²ç»å®Œæ•´å®ç°äº†è®¡åˆ’ä¸­çš„æ‰€æœ‰æ ¸å¿ƒåŠŸèƒ½ï¼š

1. âœ… **Core åŒ…** - é…ç½®ç®¡ç†ã€æ•°æ®ç”Ÿæˆã€åœºæ™¯ç®¡ç†ã€æ•°æ®åº“
2. âœ… **Server åŒ…** - RESTfulã€GraphQLã€çƒ­é‡è½½ã€WebSocket
3. âœ… **CLI åŒ…** - å®Œæ•´çš„å‘½ä»¤è¡Œå·¥å…·
4. âœ… **Web UI åŒ…** - Vue 3 ç®¡ç†ç•Œé¢

å·¥å…·åŠŸèƒ½å®Œå¤‡ï¼Œä»£ç ç»“æ„æ¸…æ™°ï¼Œæ–‡æ¡£è¯¦å°½ï¼Œå¯ä»¥ç«‹å³æŠ•å…¥ä½¿ç”¨ã€‚

## ğŸ”— ç›¸å…³æ–‡ä»¶

- è®¡åˆ’æ–‡æ¡£: `mock-tool-implementation.plan.md`
- ä¸» README: `README.md`
- åŒ…é…ç½®: `packages/*/package.json`
- æ ¸å¿ƒä»£ç : `packages/*/src/**/*.ts`

